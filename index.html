 <link rel='stylesheet' href='styles.css'><pre><code><span style='color:red;'>defmodule</span><span style='color:purple;'> </span><span style='color:purple;'>Matriz</span><span style='color:purple;'>(</span><span style='color:green;'><i>a</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>'</i></span><span style='color:green;'><i>bola</i></span><span style='color:green;'><i>'</i></span><span style='color:purple;'><i>,</i></span><span style='color:yellow;'>:atomo</span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>net1</span><span style='color:purple;'> </span><span style='color:red;'>do</span>    <span style='color:peru;'>@modulo</span>    <span style='color:pink;'>~N[2901-12-02 13:56:09:09]</span>    1 <span style='color:crimson;'>&&</span> 1.1    1 <span style='color:crimson;'>&&&</span> 1.1    ~~expr    <span style='color:crimson;'>~~~</span>expr    left <span style='color:crimson;'>|||</span> right    left <span style='color:crimson;'><<<</span> right    integer() <span style='color:crimson;'>&&&</span> integer() :: integer()    [[0,0,0,0,0,0,1,0,0,0, 0],    [0,0,0,0,0,0,0,1,0,1,0],    [0,0,0,0,0,0,0,0,1,1,0],    [0,0,0,0,0,0,0,0,0,0,1],    [0,0,0,0,0,0,0,0,0,0,1],    [0,0,0,0,0,0,0,0,0,0,0],    [0,1,1,0,0,0,0,0,0,0,0],    [0,0,0,1,0,0,0,0,0,0,0],    [0,0,0,0,1,0,0,0,0,0,0],    [0,0,0,1,1,0,0,0,0,0,0],    [0,0,0,0,0,1,0,0,0,0,0]]    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>control</span><span style='color:purple;'>(</span><span style='color:green;'><i>_</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>[</i></span><span style='color:green;'><i>]</i></span><span style='color:purple;'>)</span><span style='color:purple;'>,</span><span style='color:purple;'> </span><span style='color:red;'>do:</span> <span style='color:darkcyan;'><i>true</i></span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>mapa</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      %{        A <span style='color:red;'>=</span><span style='color:red;'>></span> 6,        B <span style='color:red;'>=</span><span style='color:red;'>></span> 7,        C <span style='color:red;'>=</span><span style='color:red;'>></span> 8,        D <span style='color:red;'>=</span><span style='color:red;'>></span> 9,        E <span style='color:red;'>=</span><span style='color:red;'>></span> 10,        P0 <span style='color:red;'>=</span><span style='color:red;'>></span> 0,        P1 <span style='color:red;'>=</span><span style='color:red;'>></span> 1,        P2 <span style='color:red;'>=</span><span style='color:red;'>></span> 2,        P3 <span style='color:red;'>=</span><span style='color:red;'>></span> 3,        P4 <span style='color:red;'>=</span><span style='color:red;'>></span> 4,        P5 <span style='color:red;'>=</span><span style='color:red;'>></span> 5      }    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>paresord</span><span style='color:purple;'> </span><span style='color:red;'>do</span>    [[P0, A],[A,P1],[A,P2],[P1,B],[P1,D],[P2,C],[P2,D],[D,P3],[D,P4],[C,P4],[P3,E],[P4,E],[E,P5],[B,P3]]    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>preset</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>node</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      <span style='color:brown;'>Enum.</span>filter(net,<span style='color:red;'>fn</span> [_,destino]-<span style='color:red;'>></span> destino <span style='color:red;'>=</span><span style='color:red;'>=</span> node <span style='color:red;'>end</span>) <span style='color:red;'>|></span> <span style='color:brown;'>Enum.</span>map(<span style='color:red;'>fn</span> [origen,_] -<span style='color:red;'>></span> origen <span style='color:red;'>end</span>) <span style='color:red;'>|></span> <span style='color:brown;'>MapSet.</span>new    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>m0</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      <span style='color:brown;'>MapSet.</span>new([P0])    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>poset</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>node</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      <span style='color:brown;'>Enum.</span>filter(net,<span style='color:red;'>fn</span> [origen,_]-<span style='color:red;'>></span> origen <span style='color:red;'>=</span><span style='color:red;'>=</span> node <span style='color:red;'>end</span>) <span style='color:red;'>|></span> <span style='color:brown;'>Enum.</span>map(<span style='color:red;'>fn</span> [_,destino] -<span style='color:red;'>></span> destino  <span style='color:red;'>end</span>) <span style='color:red;'>|></span> <span style='color:brown;'>MapSet.</span>new    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>fire</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>trans</i></span><span style='color:purple;'><i>,</i></span><span style='color:yellow;'>:marking</span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      <span style='color:red;'>if</span> <span style='color:brown;'>MapSet.</span>subset?(preset(net,trans), marking) <span style='color:red;'>do</span>        <span style='color:brown;'>MapSet.</span>difference(marking, preset(net,trans)) <span style='color:red;'>|></span> <span style='color:brown;'>MapSet.</span>union(poset(net,trans))      <span style='color:red;'>else</span>        marking      <span style='color:red;'>end</span>    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>convertir</span><span style='color:purple;'>(</span><span style='color:green;'><i>map</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      a <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>to_list(map)      a    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>getpos</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>marking</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      [a|b] <span style='color:red;'>=</span> marking      <span style='color:red;'>if</span> b <span style='color:red;'>!</span><span style='color:red;'>=</span> [] <span style='color:red;'>do</span>        posa <span style='color:red;'>=</span> poset(net,a)        posb <span style='color:red;'>=</span> poset(net,hd(b))        <span style='color:brown;'>MapSet.</span>union(posa,posb)      <span style='color:red;'>else</span>        posa <span style='color:red;'>=</span> poset(net,a)        posa      <span style='color:red;'>end</span>    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>getpres</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>trans</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      <span style='color:red;'>if</span> trans <span style='color:red;'>!</span><span style='color:red;'>=</span> [] <span style='color:red;'>do</span>        [a|b] <span style='color:red;'>=</span> trans        convertir(preset(net,a)) ++ getpres(net,b)      <span style='color:red;'>else</span>        [] <span style='color:blue;'># este es un comment</span>      <span style='color:red;'>end</span>    <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>enabl</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>marking</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>      trans <span style='color:red;'>=</span> getpos(net,marking)      trans <span style='color:red;'>=</span> convertir(trans)      pres <span style='color:red;'>=</span> getpres(net,trans)      marking <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>new(marking)      pres <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>new(pres)      pres <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>intersection(pres,marking)      pres    <span style='color:red;'>end</span>     <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>enablement</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>marking</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>       trans <span style='color:red;'>=</span> getpos(net,marking)       <span style='color:red;'>if</span> <span style='color:brown;'>MapSet.</span>subset?(,marking) <span style='color:red;'>do</span>       <span style='color:red;'>end</span>     <span style='color:red;'>end</span>    <span style='color:red;'>def</span><span style='color:purple;'> </span><span style='color:purple;'>enablement</span><span style='color:purple;'>(</span><span style='color:green;'><i>net</i></span><span style='color:purple;'><i>,</i></span><span style='color:green;'><i>marking</i></span><span style='color:purple;'>)</span><span style='color:purple;'> </span><span style='color:red;'>do</span>       <span style='color:red;'>if</span> length(marking) <span style='color:red;'>=</span><span style='color:red;'>=</span> 1 <span style='color:red;'>do</span>         <span style='color:yellow;'>:hola</span>         marking <span style='color:red;'>=</span> hd(marking)         trans <span style='color:red;'>=</span> poset(net,marking)         marking <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>new([marking])         trans <span style='color:red;'>=</span> convertir(trans)         <span style='color:red;'>if</span> <span style='color:brown;'>MapSet.</span>subset?(preset(net,trans),marking) <span style='color:red;'>do</span>           [trans]         <span style='color:red;'>else</span>           <span style='color:darkcyan;'><i>nil</i></span>           <span style='color:darkcyan;'><i>true</i></span>           <span style='color:darkcyan;'><i>false</i></span>         <span style='color:red;'>end</span>       <span style='color:red;'>else</span>          [a|b]          trans <span style='color:red;'>=</span> poset(net,marking)        marking <span style='color:red;'>=</span> <span style='color:brown;'>MapSet.</span>new([marking])          trans <span style='color:red;'>=</span> convertir(trans)          <span style='color:red;'>if</span> <span style='color:brown;'>MapSet.</span>subset?(preset(net,trans),marking) <span style='color:red;'>do</span>            [trans]         <span style='color:red;'>else</span>            <span style='color:darkcyan;'><i>nil</i></span>          <span style='color:red;'>end</span>       <span style='color:red;'>end</span>    <span style='color:red;'>end</span>  <span style='color:red;'>end</span></code></pre>